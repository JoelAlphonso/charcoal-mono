/*! @locomotivemtl/charcoal-admin */

!function(o,l){var r=o.util.Tools.each,i=o.util.Tools.extend,m=o.util.Tools.isArray;o.create("tinymce.plugins.Charcoal",{dependencies:["advlist"],listItems:["bullist","numlist","outdent","indent"],alignItems:["alignleft","aligncenter","alignright","alignjustify"],editor:null,init:function(a){var t,e,i=this;this.editor=a,t=this.filterItems(this.listItems),e=this.filterItems(this.alignItems),a.addMenuItem("lists",{text:"Lists",context:"format",menu:t}),a.addMenuItem("alignment",{text:"Alignment",context:"format",menu:e}),a.addButton("alignment",{type:"menubutton",title:"Alignment",icon:i.getDefaultAlignment(),menu:e,onPostRender:function(){var n=this;a.on("NodeChange",function(t){var e=this.formatter.matchAll(i.alignItems);(e=m(e)?e.pop():e)?"IMG"===t.element.nodeName&&(t=a.dom.getParent(t.element,"figure")||t.element,"alignnone"===e?n.active(!/\bu-align-(left|center|right)\b/.test(t.className)):n.active(a.dom.hasClass(t,e))):e=i.getDefaultAlignment(),n.icon(e)})}}),a.on("init",function(){var t=o.Env,e=a.getDoc(),n=a.dom,i=["charcoal-editor"];i.push("mceContentBody"),"rtl"===a.getParam("directionality")&&(i.push("rtl"),n.setAttrib(e.documentElement,"dir","rtl")),n.setAttrib(e.documentElement,"lang",a.getParam("root_lang_attr")),t.ie&&(9===parseInt(t.ie,10)?i.push("lt-ie10"):8===parseInt(t.ie,10)?i.push("lt-ie9"):t.ie<8&&i.push("lt-ie8")),r(i,function(t){t&&n.addClass(e.body,t)}),a.getParam("autohide_toolbar")&&l(a.getContentAreaContainer().parentElement).find("div.mce-toolbar-grp").hide(),a.getParam("autohide_menubar")&&l(a.getContentAreaContainer().parentElement).find("div.mce-menubar").hide()}),a.getParam("autohide_toolbar")&&(a.on("focus",function(){l(a.getContentAreaContainer().parentElement).find("div.mce-toolbar-grp").show()}),a.on("blur",function(){l(a.getContentAreaContainer().parentElement).find("div.mce-toolbar-grp").hide()})),a.getParam("autohide_menubar")&&(a.on("focus",function(){l(a.getContentAreaContainer().parentElement).find("div.mce-menubar").show()}),a.on("blur",function(){l(a.getContentAreaContainer().parentElement).find("div.mce-menubar").hide()})),!1===a.getParam("image_dimensions")&&a.on("NodeChange",function(t){t&&"img"===t.element.nodeName.toLowerCase()&&o.DOM.setAttribs(t.element,{width:null,height:null})})},getDefaultAlignment:function(){return"rtl"===this.editor.getParam("directionality")?"alignright":"alignleft"},filterItems:function(t){var e=this.editor,n=[];return m(t)||(t=t.split(" ")),r(t,function(t){"|"===t?n.push({text:"-"}):t in e.buttons&&((t=i({},e.buttons[t])).text=t.tooltip,delete t.tooltip,delete t.type,n.push(t))}),n}}),o.PluginManager.add("charcoal",o.plugins.Charcoal,o.plugins.Charcoal.dependencies)}(window.tinymce,window.jQuery);